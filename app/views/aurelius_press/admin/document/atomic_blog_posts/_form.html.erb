<% if controller_path.include?("admin") %>
  <% in_admin_ns = true %>
  <% form_url = (@atomic_blog_post.new_record? ? aurelius_press_admin_document_atomic_blog_posts_path : aurelius_press_admin_document_atomic_blog_post_path(@atomic_blog_post)) %>
<% else %>
  <% in_admin_ns = false %>
  <% form_url = (@atomic_blog_post.new_record? ? aurelius_press_atomic_blog_posts_path : aurelius_press_atomic_blog_post_path(@atomic_blog_post)) %>
<% end %>

<h3><%= @atomic_blog_post.new_record? ? "New" : "Edit" %> Atomic Blog Post</h3>

<%= simple_form_for @atomic_blog_post, url: form_url do |f| %>

  <%= f.error_notification %>
  <%= f.error_notification message: f.object.errors[:base].to_sentence if f.object.errors[:base].present? %>

  <div class="form-inputs">

    <%= f.input :user_id, as: :hidden, input_html: { value: current_user.id } %>

    <div class="row">
      <div class="column">
        <%= f.input :title, required: true, autofocus: true, input_html: { class: "form-control" } %>
      </div>
      <div class="column">
        <%= f.input :subtitle, input_html: { class: "form-control" } %>
      </div>
    </div>

    <div class="row">
      <div class="column">
        <%= f.input :description, as: :text, input_html: { rows: 5, class: "form-control" } %>
      </div>
    </div>

    <div class="row">
      <div class="column">
        <%= f.rich_text_area :content, id: "trix-content"  %>
      </div>
    </div>

    <div class="row">
      <div class="column">
        <%= f.input :image_file, as: :file, label: "Featured Image", hint: "Upload an image for the blog post" %>
      </div>
    </div>


    <div class="row">
      <div class="column">
        <%= f.input :category_id, collection: @categories, label_method: :name, value_method: :id, as: :select, prompt: "Select Category" %>
      </div>
      <div class="column">
        <%= f.input :tags, as: :string, label: "Tags (comma separated)", hint: "e.g., rails, ruby, webdev" %>
      </div>
      <div class="column">
        <%= f.input :published_at, as: :datetime %>
      </div>
    </div>

    <div class="row">
      <div class="column">
        <%= f.input :status, as: :select, collection: AureliusPress::Document::Document.statuses.keys, prompt: "Select Status" %>
      </div>
      <div class="column">
        <%= f.input :visibility, as: :select, collection: AureliusPress::Document::Document.visibilities.keys, prompt: "Select Visibility" %>
      </div>
    </div>

    <div class="row">
      <div class="column">
        <%= f.input :comments_enabled, as: :boolean, label: "Allow Comments?" %>
      </div>
    </div>
  </div>

  <div class="form-actions">
    <%= f.button :submit, class: "button", role: :button %>
    <% if in_admin_ns %>
      <% if @atomic_blog_post.persisted? %>
        <%= link_to "Delete", aurelius_press_admin_document_atomic_blog_post_path(@atomic_blog_post), data: { turbo_method: :delete, turbo_confirm: "Are you sure?" }, class: "button button-danger" %>
      <% end %>
      <%= link_to "Back", aurelius_press_admin_document_atomic_blog_posts_path, class: "button" %>
    <% else %>
      <% if @atomic_blog_post.persisted? %>
        <%= link_to "Delete", aurelius_press_atomic_blog_post_path(@atomic_blog_post), data: { turbo_method: :delete, turbo_confirm: "Are you sure?" }, class: "button button-danger" %>
      <% end %>
      <%= link_to "Back", aurelius_press_atomic_blog_posts_path, class: "button" %>
    <% end %>
  </div>
<% end %>
